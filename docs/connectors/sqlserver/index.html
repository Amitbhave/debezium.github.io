<!DOCTYPE html> <html lang="en"> <head> <title>Debezium Connector for SQL Server</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="" name="description"> <meta content="" name="author"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <!--[if lt IE 9]><script src="https://static.jboss.org/theme/js/libs/html5/pre3.6/html5.min.js"></script><![endif]--> <link href="https://static.jboss.org/example/images/favicon.ico" rel="shortcut icon"> <link href="https://static.jboss.org/example/images/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="https://static.jboss.org/example/images/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="https://static.jboss.org/example/images/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="https://static.jboss.org/example/images/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="/stylesheets/debezium.css" rel="stylesheet" type="text/css"> <style>
      @media (min-width: 980px) {
        .banner { background-image: url(https://static.jboss.org/example/images/debezium-banner-1180px.png); height: 110px;  }
      }
      @media (max-width: 979px) {
        .banner { background-image: url(https://static.jboss.org/example/images/debezium-logo.png); background-repeat:no-repeat; background-position: center bottom; height: 60px; }
      }
      @media (max-width: 650px) {
        .banner { width: 100%; margin: 0px auto; }
      }
      @media (max-width: 450px) {
        .banner { height: 90px; }
      }
    </style> <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css" rel="stylesheet"> <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script src="https://static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <style>
      /* adjusting the vertical spacing for when a stickynav is engaged */
      .breadcrumb-fixed > .active {
        color: #8c8f91;
      }
      .breadcrumb-fixed {
        margin: 70px 0 10px;
        padding: 8px 15px;
        margin-bottom: 20px;
        list-style: none;
        background-color: #f5f5f5;
        border-radius: 4px;
      }
      
      .breadcrumb-fixed > li {
        display: inline-block;
      }
    </style> </head> <body> <div id="rhbar"> <a class="jbdevlogo" href="https://www.jboss.org/projects/about"></a> <a class="rhlogo" href="https://www.redhat.com/"></a> </div> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div class="container" id="content"> <div class="navbar navbar-inverse navbar-fix"> <div class="container-fluid"> <div class="navbar-header"> <button class="navbar-toggle collapsed" data-target="#navbar-1" data-toggle="collapse"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> Debezium </a> </div> <div class="collapse navbar-collapse" id="navbar-1"> <ul class="nav navbar-nav pull-right"> <li class=""><a href="/docs/faq/">FAQ</a></li> <li class="active"><a href="/docs/">DOCS</a></li> <li class=""><a href="/community/">COMMUNITY</a></li> <li class=""><a href="/blog/">BLOG</a></li> </ul> </div> </div> </div> <div id="equalHeightsLayout"> <div class="col-sm-3" id="leftdocnav"> <div class="panel-group" id="accordion1"> <div class="panel panel-docnav"> <div class="panel-heading"> <h4 class="panel-title"> <a class="accordion-toggle" data-parent="#accordion1,#accordion2,#accordion3,#accordion4,#accordion5" data-toggle="collapse" href="#collapse1"> Get Started </a> </h4> </div> <div class="collapse panel-collapse" id="collapse1"><div class="panel-body"> <ul class="list-group"> <li class="list-group-item"><a href="/docs/concepts/">Concepts</a></li> <li class="list-group-item"><a href="/docs/tutorial/">Tutorial</a></li> <li class="list-group-item"><a href="/docs/install/">Installing Debezium</a></li> <li class="list-group-item"><a href="/docs/embedded/">Embedding Debezium</a></li> <li class="list-group-item"><a href="/docs/openshift/">Running on OpenShift</a></li> <li class="list-group-item"><a href="/docs/monitoring/">Monitoring Debezium</a></li> <li class="list-group-item"><a href="/docs/online-resources/">Resources on the Web</a></li> <li class="list-group-item"><a href="/docs/releases/">Releases</a></li> </ul> </div></div> </div> </div> <div class="panel-group" id="accordion2"> <div class="panel panel-docnav"> <div class="panel-heading"> <h4 class="panel-title"> <a class="accordion-toggle" data-parent="#accordion1,#accordion2,#accordion3,#accordion4,#accordion5" data-toggle="collapse" href="#collapse2"> Configuration </a> </h4> </div> <div class="collapse panel-collapse" id="collapse2"><div class="panel-body"> <ul class="list-group"> <li class="list-group-item"><a href="/docs/configuration/logging/">Logging</a></li> <li class="list-group-item"><a href="/docs/configuration/avro/">Avro Serialization</a></li> <li class="list-group-item"><a href="/docs/configuration/topic-routing/">Topic Routing</a></li> <li class="list-group-item"><a href="/docs/configuration/event-flattening/">CDC Event Flattening</a></li> <li class="list-group-item"><a href="/docs/configuration/mongodb-event-flattening/">MongoDB CDC Event Flattening</a></li> </ul> </div></div> </div> </div> <div class="panel-group" id="accordion3"> <div class="panel panel-docnav"> <div class="panel-heading"> <h4 class="panel-title"> <a class="accordion-toggle" data-parent="#accordion1,#accordion2,#accordion3,#accordion4,#accordion5" data-toggle="collapse" href="#collapse3"> Connectors </a> </h4> </div> <div class="collapse in panel-collapse" id="collapse3"><div class="panel-body"> <ul class="list-group"> <li class="list-group-item"><a href="/docs/connectors/mysql/">MySQL</a></li> <li class="list-group-item"><a href="/docs/connectors/mongodb/">MongoDB</a></li> <li class="list-group-item"><a href="/docs/connectors/postgresql/">PostgreSQL</a></li> <li class="list-group-item"><a href="/docs/connectors/oracle/">Oracle</a></li> <li class="active list-group-item"><a href="/docs/connectors/sqlserver/">SQL Server</a></li> </ul> </div></div> </div> </div> <div class="panel-group" id="accordion4"> <div class="panel panel-docnav"> <div class="panel-heading"> <h4 class="panel-title"> <a class="accordion-toggle" data-parent="#accordion1,#accordion2,#accordion3,#accordion4,#accordion5" data-toggle="collapse" href="#collapse4"> How it works </a> </h4> </div> <div class="collapse panel-collapse" id="collapse4"><div class="panel-body"> <ul class="list-group"> <li class="list-group-item"><a href="/docs/faq/">FAQ</a></li> <li class="list-group-item"><a href="/docs/architecture/">Debezium Architecture</a></li> <li class="list-group-item"><a href="/docs/features/">Debezium Features</a></li> </ul> </div></div> </div> </div> <div class="panel-group" id="accordion5"> <div class="panel panel-docnav"> <div class="panel-heading"> <h4 class="panel-title"> <a class="accordion-toggle" data-parent="#accordion1,#accordion2,#accordion3,#accordion4,#accordion5" data-toggle="collapse" href="#collapse5"> Contribute </a> </h4> </div> <div class="collapse panel-collapse" id="collapse5"><div class="panel-body"> <ul class="list-group"> <li class="list-group-item"><a href="/docs/contribute/">Contribute to Debezium</a></li> <li class="list-group-item"><a href="/docs/code-of-conduct/">Code of Conduct</a></li> <li class="list-group-item"> <a href="https://twitter.com/debezium">Twitter</a> </li> <li class="list-group-item"> <a href="https://gitter.im/debezium/dev">Chat</a> </li> <li class="list-group-item"> <a href="https://github.com/debezium/">Code</a> </li> <li class="list-group-item"> <a href="https://issues.jboss.org/projects/DBZ/issues">Issues</a> </li> </ul> </div></div> </div> </div> <div class="panel-group" id="accordion6"> <div class="panel panel-docnav"> <div class="panel-heading"> <h4 class="panel-title"> <a href="/docs/roadmap/">Roadmap</a> </h4> </div> </div> </div> </div> <div class="col-sm-9" id="maincol"> <h1 class="title"> Debezium Connector for SQL Server </h1> <div id="preamble"> <div class="sectionbody"> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>This connector has been released in a first stable version as of Debezium 0.9. Want to help us further hone and improve it? <a href="/docs/contribute/">Learn how</a>.</p> </div> </td> </tr> </table> </div> <div id="toc" class="toc"> <div id="toctitle" class="title">Table of Contents</div> <ul class="sectlevel1"> <li><a href="#overview">Overview</a></li> <li><a href="#setting-up-sqlserver">Setting up SQL Server</a> <ul class="sectlevel2"> <li><a href="#azure">SQL Server on Azure</a></li> </ul> </li> <li><a href="#how-the-connector-works">How the SQL Server connector works</a> <ul class="sectlevel2"> <li><a href="#schema-evolution">Database schema evolution</a></li> <li><a href="#data-types">Data types</a></li> </ul> </li> <li><a href="#deploying-a-connector">Deploying a connector</a> <ul class="sectlevel2"> <li><a href="#example-configuration">Example configuration</a></li> <li><a href="#connector-properties">Connector properties</a></li> </ul> </li> </ul> </div> <div class="paragraph"> <p>Debezium&#8217;s SQL Server Connector can monitor and record the row-level changes in the schemas of a SQL Server 2017 database. This connector was added in Debezium 0.9.0.</p> </div> <div class="paragraph"> <p>The first time it connects to a SQL Server database/cluster, it reads a consistent snapshot of all of the schemas. When that snapshot is complete, the connector continuously streams the changes that were committed to SQL Server and generates corresponding insert, update and delete events. All of the events for each table are recorded in a separate Kafka topic, where they can be easily consumed by applications and services.</p> </div> </div> </div> <div class="sect1"> <h2 id="overview"><a class="anchor" href="#overview"></a>Overview</h2> <div class="sectionbody"> <div class="paragraph"> <p>The functionality of the connector is based upon <a href="https://docs.microsoft.com/en-us/sql/relational-databases/track-changes/about-change-data-capture-sql-server?view=sql-server-2017">change data capture</a> feature provided by SQL Server Standard (<a href="https://blogs.msdn.microsoft.com/sqlreleaseservices/sql-server-2016-service-pack-1-sp1-released/">since SQL Server 2016 SP1</a>) or Enterprise edition. Using this mechanism a SQL Server capture process monitors all databases and tables the user is interested in and stores the changes into specifically created <em>CDC</em> tables that have stored procedure facade.</p> </div> <div class="paragraph"> <p>The database operator must <a href="https://docs.microsoft.com/en-us/sql/relational-databases/track-changes/enable-and-disable-change-data-capture-sql-server?view=sql-server-2017">enable</a> <em>CDC</em> for the table(s) that should be captured by the Debezium connector. The connector then produces a <em>change event</em> for every row-level insert, update, and delete operation that was published via the <em>CDC API</em>, recording all the change events for each table in a separate Kafka topic. The client applications read the Kafka topics that correspond to the database tables they&#8217;re interested in following, and react to every row-level event it sees in those topics.</p> </div> <div class="paragraph"> <p>The database operator normally enables <em>CDC</em> in the mid-life of a database an/or table. This means that the connector won&#8217;t have the complete history of all changes that have been made to the database. Therefore, when the SQL Server connector first connects to a particular SQL Server database, it starts by performing a <em>consistent snapshot</em> of each of the database schemas. After the connector completes the snapshot, it continues streaming changes from the exact point at which the snapshot was made. This way, we start with a consistent view of all of the data, yet continue reading without having lost any of the changes made while the snapshot was taking place.</p> </div> <div class="paragraph"> <p>The connector is also tolerant of failures. As the connector reads changes and produces events, it records the position in the database log (<em>LSN / Log Sequence Number</em>), that is associated with <em>CDC</em> record, with each event. If the connector stops for any reason (including communication failures, network problems, or crashes), upon restart it simply continues reading the <em>CDC</em> tables where it last left off. This includes snapshots: if the snapshot was not completed when the connector is stopped, upon restart it will begin a new snapshot.</p> </div> </div> </div> <div class="sect1"> <h2 id="setting-up-sqlserver"><a class="anchor" href="#setting-up-sqlserver"></a>Setting up SQL Server</h2> <div class="sectionbody"> <div class="paragraph"> <p>Before using the Debezium SQL Server connector to monitor the changes committed on SQL Server, first enable <em>CDC</em> on a monitored database. Please bear in mind that <em>CDC</em> cannot be enabled for <code>master</code> database.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">-- ====&#x000A;-- Enable Database for CDC template&#x000A;-- ====&#x000A;USE MyDB&#x000A;GO&#x000A;EXEC sys.sp_cdc_enable_db&#x000A;GO</code></pre> </div> </div> <div class="paragraph"> <p>Then enable <em>CDC</em> for each table that you plan to monitor</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">-- =========&#x000A;-- Enable a Table Specifying Filegroup Option Template&#x000A;-- =========&#x000A;USE MyDB&#x000A;GO&#x000A;&#x000A;EXEC sys.sp_cdc_enable_table&#x000A;@source_schema = N'dbo',&#x000A;@source_name   = N'MyTable',&#x000A;@role_name     = N'MyRole',&#x000A;@filegroup_name = N'MyDB_CT',&#x000A;@supports_net_changes = 1&#x000A;GO</code></pre> </div> </div> <div class="sect2"> <h3 id="azure"><a class="anchor" href="#azure"></a>SQL Server on Azure</h3> <div class="paragraph"> <p>The SQL Server plug-in has not been tested with SQL Server on Azure. We welcome any feedback from a user to try the plug-in with database in managed environment.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="how-the-connector-works"><a class="anchor" href="#how-the-connector-works"></a>How the SQL Server connector works</h2> <div class="sectionbody"> <div class="paragraph"> <p>TBD</p> </div> <div class="sect2"> <h3 id="schema-evolution"><a class="anchor" href="#schema-evolution"></a>Database schema evolution</h3> <div class="paragraph"> <p>Debezium is able to capture schema changes over time. Due to the way CDC is implemented in SQL Server, it is necessary to work in co-operation with a database operator in order to ensure the Debezium connector continues to produce data change events when the schema is updated.</p> </div> <div class="paragraph"> <p>As was already mentioned before, Debezium uses SQL Server&#8217;s change data capture functionality. This means that SQL Server creates a capture table that contains all changes executed on the source table. Unfortunately, the capture table is static and needs to be updated when the source table structure changes. This update is not done by the Debezium connector itself but must be executed by an operator with elevated privileges.</p> </div> <div class="paragraph"> <p>There are generally two procedures how to execute the schema change:</p> </div> <div class="ulist"> <ul> <li> <p>cold - this is executed when Debezium is stopped</p> </li> <li> <p>hot - executed while Debezium is running</p> </li> </ul> </div> <div class="paragraph"> <p>Both approaches have their own advantages and disadvantages.</p> </div> <div class="admonitionblock warning"> <table> <tr> <td class="icon"> <i class="fa icon-warning" title="Warning"></i> </td> <td class="content"> <div class="paragraph"> <p>In both cases, it is critically important to execute the procedure completely before a new schema update on the same source table is made. It is thus recommended to execute all DDLs in a single batch so the procedure is done only once.</p> </div> </td> </tr> </table> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>Not all schema changes are supported when CDC is enabled for a source table. One such exception identified is renaming a column or changing its type, SQL Server will not allow executing the operation.</p> </div> </td> </tr> </table> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>Although not required by SQL Server&#8217;s CDC mechanism itself, a new capture instance must be created when altering a column from <code>NULL</code> to <code>NOT NULL</code> or vice versa. This is required so that the Debezium SQL Server connector can pick up that changed information. Otherwise, emitted change events will have the <code>optional</code> value for the corresponding field (<code>true</code> or <code>false</code>) set to match the original value.</p> </div> </td> </tr> </table> </div> <div class="sect3"> <h4 id="cold_schema_update"><a class="anchor" href="#cold_schema_update"></a>Cold schema update</h4> <div class="paragraph"> <p>This is the safest procedure but might not be feasible for applications with high-availability requirements. The operator should follow this sequence of steps</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Suspend the application that generates the database records</p> </li> <li> <p>Wait for Debezium to stream all unstreamed changes</p> </li> <li> <p>Stop Debezium connector</p> </li> <li> <p>Apply all changes to the source table schema</p> </li> <li> <p>Create a new capture table for the update source table using <code>sys.sp_cdc_enable_table</code> procedure with a unique value for parameter <code>@capture_instance</code></p> </li> <li> <p>Resume the application</p> </li> <li> <p>Start Debezium connector</p> </li> <li> <p>When Debezium starts streaming from the new capture table it is possible to drop the old one using <code>sys.sp_cdc_disable_table</code> stored procedure with parameter <code>@capture_instance</code> set to the old capture instance name</p> </li> </ol> </div> </div> <div class="sect3"> <h4 id="hot_schema_update"><a class="anchor" href="#hot_schema_update"></a>Hot schema update</h4> <div class="paragraph"> <p>The hot schema update does not require any downtime in application and data processing. The procedure itself is also much simpler than in case of cold schema update</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Apply all changes to the source table schema</p> </li> <li> <p>Create a new capture table for the update source table using <code>sys.sp_cdc_enable_table</code> procedure with a unique value for parameter <code>@capture_instance</code></p> </li> <li> <p>When Debezium starts streaming from the new capture table it is possible to drop the old one using <code>sys.sp_cdc_disable_table</code> stored procedure with parameter <code>@capture_instance</code> set to the old capture instance name</p> </li> </ol> </div> <div class="paragraph"> <p>The hot schema update has one drawback. There is a period of time between the database schema update and creating the new capture instance. All changes that will arrive during this period will be captured by the old instance with the old structure. For instance this means that in case of a newly added column any change event produced during this time will not yet contain a field for that new column. If your application does not tolerate such a transition period we recommend to follow the cold schema update.</p> </div> </div> <div class="sect3"> <h4 id="example"><a class="anchor" href="#example"></a>Example</h4> <div class="paragraph"> <p>Let&#8217;s deploy the SQL Server based <a href="https://github.com/debezium/debezium-examples/tree/master/tutorial#using-sql-server">Debezium tutorial</a> to demonstrate the hot schema update. A column <code>phone_number</code> will be added to the <code>customers</code> table.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># Start the database shell&#x000A;docker-compose -f docker-compose-sqlserver.yaml exec sqlserver bash -c '/opt/mssql-tools/bin/sqlcmd -U sa -P $SA_PASSWORD -d testDB'</code></pre> </div> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">-- Modify the source table schema&#x000A;ALTER TABLE customers ADD phone_number VARCHAR(32);&#x000A;&#x000A;-- Create the new capture instance&#x000A;EXEC sys.sp_cdc_enable_table @source_schema = 'dbo', @source_name = 'customers', @role_name = NULL, @supports_net_changes = 0, @capture_instance = 'dbo_customers_v2';&#x000A;GO&#x000A;&#x000A;-- Insert new data&#x000A;INSERT INTO customers(first_name,last_name,email,phone_number) VALUES ('John','Doe','john.doe@example.com', '+1-555-123456');&#x000A;GO</code></pre> </div> </div> <div class="paragraph"> <p>Kafka Connect log will contain messages like these:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code>connect_1    | 2019-01-17 10:11:14,924 INFO   ||  Multiple capture instances present for the same table: Capture instance "dbo_customers" [sourceTableId=testDB.dbo.customers, changeTableId=testDB.cdc.dbo_customers_CT, startLsn=00000024:00000d98:0036, changeTableObjectId=1525580473, stopLsn=00000025:00000ef8:0048] and Capture instance "dbo_customers_v2" [sourceTableId=testDB.dbo.customers, changeTableId=testDB.cdc.dbo_customers_v2_CT, startLsn=00000025:00000ef8:0048, changeTableObjectId=1749581271, stopLsn=NULL]   [io.debezium.connector.sqlserver.SqlServerStreamingChangeEventSource]&#x000A;connect_1    | 2019-01-17 10:11:14,924 INFO   ||  Schema will be changed for ChangeTable [captureInstance=dbo_customers_v2, sourceTableId=testDB.dbo.customers, changeTableId=testDB.cdc.dbo_customers_v2_CT, startLsn=00000025:00000ef8:0048, changeTableObjectId=1749581271, stopLsn=NULL]   [io.debezium.connector.sqlserver.SqlServerStreamingChangeEventSource]&#x000A;...&#x000A;connect_1    | 2019-01-17 10:11:33,719 INFO   ||  Migrating schema to ChangeTable [captureInstance=dbo_customers_v2, sourceTableId=testDB.dbo.customers, changeTableId=testDB.cdc.dbo_customers_v2_CT, startLsn=00000025:00000ef8:0048, changeTableObjectId=1749581271, stopLsn=NULL]   [io.debezium.connector.sqlserver.SqlServerStreamingChangeEventSource]</code></pre> </div> </div> <div class="paragraph"> <p>Eventually, there will be a new field in the schema and value of the messages written to the Kafka topic.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">...&#x000A;     {&#x000A;        "type": "string",&#x000A;        "optional": true,&#x000A;        "field": "phone_number"&#x000A;     }&#x000A;...&#x000A;    "after": {&#x000A;      "id": 1005,&#x000A;      "first_name": "John",&#x000A;      "last_name": "Doe",&#x000A;      "email": "john.doe@example.com",&#x000A;      "phone_number": "+1-555-123456"&#x000A;    },</code></pre> </div> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">-- Drop the old capture instance&#x000A;EXEC sys.sp_cdc_disable_table @source_schema = 'dbo', @capture_instance = 'dbo_customers', @capture_instance = 'dbo_customers';&#x000A;GO</code></pre> </div> </div> </div> </div> <div class="sect2"> <h3 id="data-types"><a class="anchor" href="#data-types"></a>Data types</h3> <div class="paragraph"> <p>As described above, the SQL Server connector represents the changes to rows with events that are structured like the table in which the row exist. The event contains a field for each column value, and how that value is represented in the event depends on the SQL data type of the column. This section describes this mapping.</p> </div> <div class="paragraph"> <p>The following table describes how the connector maps each of the SQL Server data types to a <em>literal type</em> and <em>semantic type</em> within the events' fields. Here, the <em>literal type</em> describes how the value is literally represented using Kafka Connect schema types, namely <code>INT8</code>, <code>INT16</code>, <code>INT32</code>, <code>INT64</code>, <code>FLOAT32</code>, <code>FLOAT64</code>, <code>BOOLEAN</code>, <code>STRING</code>, <code>BYTES</code>, <code>ARRAY</code>, <code>MAP</code>, and <code>STRUCT</code>. The <em>semantic type</em> describes how the Kafka Connect schema captures the <em>meaning</em> of the field using the name of the Kafka Connect schema for the field.</p> </div> <table class="tableblock frame-all grid-all spread table table-bordered table-striped"> <colgroup> <col style="width: 20%;"> <col style="width: 15%;"> <col style="width: 30%;"> <col style="width: 35%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">SQL Server Data Type</th> <th class="tableblock halign-left valign-top">Literal type (schema type)</th> <th class="tableblock halign-left valign-top">Semantic type (schema name)</th> <th class="tableblock halign-left valign-top">Notes</th> </tr> </thead> <tfoot> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>DATETIMEOFFSET[(P)]</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>STRING</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>io.debezium.time.ZonedTimestamp</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>A string representation of a timestamp with timezone information, where the timezone is GMT</p> </div></div></td> </tr> </tfoot> <tbody> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>BIT</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>BOOLEAN</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>n/a</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>TINYINT</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT16</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>n/a</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>SMALLINT</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT16</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>n/a</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT32</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>n/a</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>BIGINT</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT64</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>n/a</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>REAL</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>FLOAT32</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>n/a</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>FLOAT[(N)]</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>FLOAT64</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>n/a</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>CHAR[(N)]</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>STRING</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>n/a</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>VARCHAR[(N)]</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>STRING</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>n/a</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>TEXT</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>STRING</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>n/a</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>NCHAR[(N)]</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>STRING</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>n/a</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>NVARCHAR[(N)]</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>STRING</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>n/a</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>NTEXT</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>STRING</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>n/a</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>XML</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>STRING</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>io.debezium.data.Xml</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Contains the string representation of a XML document</p> </div></div></td> </tr> </tbody> </table> <div class="paragraph"> <p>Other data type mappings are described in the following sections.</p> </div> <div class="paragraph"> <p>If present, a column&#8217;s default value will be propagated to the corresponding field&#8217;s Kafka Connect schema. Change messages will contain the field&#8217;s default value (unless an explicit column value had been given), so there should rarely be the need to obtain the default value from the schema. Passing the default value helps though with satisfying the compatibility rules when <a href="/docs/configuration/avro/">using Avro</a> as serialization format together with the Confluent schema registry.</p> </div> <div class="sect3"> <h4 id="temporal_values"><a class="anchor" href="#temporal_values"></a>Temporal values</h4> <table class="tableblock frame-all grid-all spread table table-bordered table-striped"> <colgroup> <col style="width: 20%;"> <col style="width: 15%;"> <col style="width: 30%;"> <col style="width: 35%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">SQL Server Data Type</th> <th class="tableblock halign-left valign-top">Literal type (schema type)</th> <th class="tableblock halign-left valign-top">Semantic type (schema name)</th> <th class="tableblock halign-left valign-top">Notes</th> </tr> </thead> <tfoot> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>DATETIME2(7)</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT64</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>io.debezium.time.NanoTimestamp</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Represents the number of nanoseconds past epoch, and does not include timezone information.</p> </div></div></td> </tr> </tfoot> <tbody> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>DATE</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT32</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>io.debezium.time.Date</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Represents the number of days since epoch.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>TIME(0)</code>, <code>TIME(1)</code>, <code>TIME(2)</code>, <code>TIME(3)</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT32</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>io.debezium.time.Time</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Represents the number of milliseconds past midnight, and does not include timezone information.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>TIME(4)</code>, <code>TIME(5)</code>, <code>TIME(6)</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT64</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>io.debezium.time.MicroTime</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Represents the number of microseconds past midnight, and does not include timezone information.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>TIME(7)</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT64</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>io.debezium.time.NanoTime</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Represents the number of nanoseconds past midnight, and does not include timezone information.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>DATETIME</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT64</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>io.debezium.time.Timestamp</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Represents the number of milliseconds past epoch, and does not include timezone information.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>SMALLDATETIME</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT64</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>io.debezium.time.Timestamp</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Represents the number of milliseconds past epoch, and does not include timezone information.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>DATETIME2(0)</code>, <code>DATETIME2(1)</code>, <code>DATETIME2(2)</code>, <code>DATETIME2(3)</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT64</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>io.debezium.time.Timestamp</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Represents the number of milliseconds past epoch, and does not include timezone information.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>DATETIME2(4)</code>, <code>DATETIME2(5)</code>, <code>DATETIME2(6)</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>INT64</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>io.debezium.time.MicroTimestamp</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Represents the number of microseconds past epoch, and does not include timezone information.</p> </div></div></td> </tr> </tbody> </table> <div class="sect4"> <h5 id="timestamp-values"><a class="anchor" href="#timestamp-values"></a>Timestamp values</h5> <div class="paragraph"> <p>The <code>DATETIME</code>, <code>SMALLDATETIME</code> and <code>DATETIME2</code> types represent a timestamp without time zone information. Such columns are converted into an equivalent Kafka Connect value based on UTC. So for instance the <code>DATETIME2</code> value "2018-06-20 15:13:16.945104" will be represented by a <code>io.debezium.time.MicroTimestamp</code> with the value "1529507596945104".</p> </div> <div class="paragraph"> <p>Note that the timezone of the JVM running Kafka Connect and Debezium does not affect this conversion.</p> </div> </div> </div> <div class="sect3"> <h4 id="decimal_values"><a class="anchor" href="#decimal_values"></a>Decimal values</h4> <table class="tableblock frame-all grid-all spread table table-bordered table-striped"> <colgroup> <col style="width: 15%;"> <col style="width: 15%;"> <col style="width: 35%;"> <col style="width: 35%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">PostgreSQL Data Type</th> <th class="tableblock halign-left valign-top">Literal type (schema type)</th> <th class="tableblock halign-left valign-top">Semantic type (schema name)</th> <th class="tableblock halign-left valign-top">Notes</th> </tr> </thead> <tfoot> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>MONEY</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>BYTES</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>org.apache.kafka.connect.data.Decimal</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>The <code>scale</code> schema parameter contains an integer representing how many digits the decimal point was shifted. The <code>connect.decimal.precision</code> schema parameter contains an integer representing the precision of the given decimal value.</p> </div></div></td> </tr> </tfoot> <tbody> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>NUMERIC[(P[,S])]</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>BYTES</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>org.apache.kafka.connect.data.Decimal</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>The <code>scale</code> schema parameter contains an integer representing how many digits the decimal point was shifted. The <code>connect.decimal.precision</code> schema parameter contains an integer representing the precision of the given decimal value.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>DECIMAL[(P[,S])]</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>BYTES</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>org.apache.kafka.connect.data.Decimal</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>The <code>scale</code> schema parameter contains an integer representing how many digits the decimal point was shifted. The <code>connect.decimal.precision</code> schema parameter contains an integer representing the precision of the given decimal value.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>SMALLMONEY</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>BYTES</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>org.apache.kafka.connect.data.Decimal</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>The <code>scale</code> schema parameter contains an integer representing how many digits the decimal point was shifted. The <code>connect.decimal.precision</code> schema parameter contains an integer representing the precision of the given decimal value.</p> </div></div></td> </tr> </tbody> </table> </div> </div> </div> </div> <div class="sect1"> <h2 id="deploying-a-connector"><a class="anchor" href="#deploying-a-connector"></a>Deploying a connector</h2> <div class="sectionbody"> <div class="paragraph"> <p>If you&#8217;ve already installed <a href="https://zookeeper.apache.org">Zookeeper</a>, <a href="http://kafka.apache.org/">Kafka</a>, and <a href="http://kafka.apache.org/documentation.html#connect">Kafka Connect</a>, then using Debezium&#8217;s SQL Server` connector is easy. Simply download the <a href="https://repo1.maven.org/maven2/io/debezium/debezium-connector-sqlserver/0.9.0.Alpha1/debezium-connector-sqlserver-0.9.0.Alpha1-plugin.tar.gz">connector&#8217;s plugin archive</a>, extract the JARs into your Kafka Connect environment, and add the directory with the JARs to <a href="http://docs.confluent.io/5.1.2/connect/userguide.html#installing-plugins">Kafka Connect&#8217;s classpath</a>. Restart your Kafka Connect process to pick up the new JARs.</p> </div> <div class="paragraph"> <p>If immutable containers are your thing, then check out <a href="https://hub.docker.com/r/debezium/">Debezium&#8217;s Docker images</a> for Zookeeper, Kafka and Kafka Connect with the SQL Server connector already pre-installed and ready to go. You can even <a href="/docs/openshift/">run Debezium on OpenShift</a>.</p> </div> <div class="paragraph"> <p>To use the connector to produce change events for a particular SQL Server database or cluster:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>enable the <a href="#setting-up-sqlserver">CDC on SQL Server</a> to publish the <em>CDC</em> events in the database</p> </li> <li> <p>create a <a href="#example-configuration">configuration file for the SQL Server Connector</a> and use the <a href="https://docs.confluent.io/5.1.2/connect/restapi.html">Kafka Connect REST API</a> to add that connector to your Kafka Connect cluster.</p> </li> </ol> </div> <div class="paragraph"> <p>When the connector starts, it will grab a consistent snapshot of the schemas in your SQL Server database and start streaming changes, producing events for every inserted, updated, and deleted row. You can also choose to produce events for a subset of the schemas and tables. Optionally ignore, mask, or truncate columns that are sensitive, too large, or not needed.</p> </div> <div class="sect2"> <h3 id="example-configuration"><a class="anchor" href="#example-configuration"></a>Example configuration</h3> <div class="paragraph"> <p>Using the SQL Server connector is straightforward. Here is an example of the configuration for a connector instance that monitors a SQL Server server at port 3306 on 192.168.99.100, which we logically name <code>fullfillment</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{&#x000A;  "name": "inventory-connector",  <i class="conum" data-value="1"></i><b>(1)</b>&#x000A;  "config": {&#x000A;    "connector.class": "io.debezium.connector.sqlserver.SqlServerConnector", <i class="conum" data-value="2"></i><b>(2)</b>&#x000A;    "database.hostname": "192.168.99.100", <i class="conum" data-value="3"></i><b>(3)</b>&#x000A;    "database.port": "1433", <i class="conum" data-value="4"></i><b>(4)</b>&#x000A;    "database.user": "sa", <i class="conum" data-value="5"></i><b>(5)</b>&#x000A;    "database.password": "Password!", <i class="conum" data-value="6"></i><b>(6)</b>&#x000A;    "database.dbname": "testDB", <i class="conum" data-value="7"></i><b>(7)</b>&#x000A;    "database.server.name": "fullfillment", <i class="conum" data-value="8"></i><b>(8)</b>&#x000A;    "table.whitelist": "customers", <i class="conum" data-value="9"></i><b>(9)</b>&#x000A;    "database.history.kafka.bootstrap.servers": "kafka:9092", <i class="conum" data-value="10"></i><b>(10)</b>&#x000A;    "database.history.kafka.topic": "dbhistory.fullfillment" <i class="conum" data-value="11"></i><b>(11)</b>&#x000A;  }&#x000A;}</code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>The name of our connector when we register it with a Kafka Connect service.</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>The name of this SQL Server connector class.</td> </tr> <tr> <td><i class="conum" data-value="3"></i><b>3</b></td> <td>The address of the SQL Server instance.</td> </tr> <tr> <td><i class="conum" data-value="4"></i><b>4</b></td> <td>The port number of the SQL Server instance.</td> </tr> <tr> <td><i class="conum" data-value="5"></i><b>5</b></td> <td>The name of the SQL Server user</td> </tr> <tr> <td><i class="conum" data-value="6"></i><b>6</b></td> <td>The password for the SQL Server user</td> </tr> <tr> <td><i class="conum" data-value="7"></i><b>7</b></td> <td>The name of the database to capture changes from</td> </tr> <tr> <td><i class="conum" data-value="8"></i><b>8</b></td> <td>The logical name of the SQL Server instance/cluster, which forms a namespace and is used in all the names of the Kafka topics to which the connector writes, the Kafka Connect schema names, and the namespaces of the corresponding Avro schema when the <a href="/docs/configuration/avro/">Avro Connector</a> is used.</td> </tr> <tr> <td><i class="conum" data-value="9"></i><b>9</b></td> <td>A list of all tables whose changes Debezium should capture</td> </tr> <tr> <td><i class="conum" data-value="10"></i><b>10</b></td> <td>The list of Kafka brokers that this connector will use to write and recover DDL statements to the database history topic.</td> </tr> <tr> <td><i class="conum" data-value="11"></i><b>11</b></td> <td>The name of the database history topic where the connector will write and recover DDL statements. This topic is for internal use only and should not be used by consumers.</td> </tr> </table> </div> <div class="paragraph"> <p>See the <a href="#connector-properties">complete list of connector properties</a> that can be specified in these configurations.</p> </div> <div class="paragraph"> <p>This configuration can be sent via POST to a running Kafka Connect service, which will then record the configuration and start up the one connector task that will connect to the SQL Server database, read the transaction log, and record events to Kafka topics.</p> </div> </div> <div class="sect2"> <h3 id="connector-properties"><a class="anchor" href="#connector-properties"></a>Connector properties</h3> <div class="paragraph"> <p>The following configuration properties are <em>required</em> unless a default value is available.</p> </div> <table class="tableblock frame-all grid-all spread table table-bordered table-striped"> <colgroup> <col style="width: 35%;"> <col style="width: 10%;"> <col style="width: 55%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Property</th> <th class="tableblock halign-left valign-top">Default</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tfoot> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>column.propagate.source.type</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><em>n/a</em></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>An optional comma-separated list of regular expressions that match the fully-qualified names of columns whose original type and length should be added as a parameter to the corresponding field schemas in the emitted change messages. The schema parameters <code>__debezium.source.column.type</code>, <code>__debezium.source.column.length</code> and <code>__debezium.source.column.scale</code> will be used to propagate the original type name and length (for variable-width types), respectively. Useful to properly size corresponding columns in sink databases. Fully-qualified names for columns are of the form <em>schemaName</em>.<em>tableName</em>.<em>columnName</em>.</p> </div></div></td> </tr> </tfoot> <tbody> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>name</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Unique name for the connector. Attempting to register again with the same name will fail. (This property is required by all Kafka Connect connectors.)</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>connector.class</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>The name of the Java class for the connector. Always use a value of <code>io.debezium.connector.sqlserver.SqlServerConnector</code> for the SQL Server connector.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>tasks.max</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>1</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>The maximum number of tasks that should be created for this connector. The SQL Server connector always uses a single task and therefore does not use this value, so the default is always acceptable.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>database.hostname</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>IP address or hostname of the SQL Server database server.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>database.port</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>1433</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Integer port number of the SQL Server database server.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>database.user</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Username to use when when connecting to the SQL Server database server.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>database.password</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Password to use when when connecting to the SQL Server database server.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>database.dbname</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>The name of the SQL Server database from which to stream the changes</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>database.server.name</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Logical name that identifies and provides a namespace for the particular SQL Server database server being monitored. The logical name should be unique across all other connectors, since it is used as a prefix for all Kafka topic names emanating from this connector.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>database.history.kafka.topic</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>The full name of the Kafka topic where the connector will store the database schema history.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>database.history&#8203;.kafka.bootstrap.servers</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>A list of host/port pairs that the connector will use for establishing an initial connection to the Kafka cluster. This connection will be used for retrieving database schema history previously stored by the connector, and for writing each DDL statement read from the source database. This should point to the same Kafka cluster used by the Kafka Connect process.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>table.whitelist</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>An optional comma-separated list of regular expressions that match fully-qualified table identifiers for tables to be monitored; any table not included in the whitelist will be excluded from monitoring. Each identifier is of the form <em>schemaName</em>.<em>tableName</em>. By default the connector will monitor every non-system table in each monitored schema. May not be used with <code>table.blacklist</code>.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>table.blacklist</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>An optional comma-separated list of regular expressions that match fully-qualified table identifiers for tables to be excluded from monitoring; any table not included in the blacklist will be monitored. Each identifier is of the form <em>schemaName</em>.<em>tableName</em>. May not be used with <code>table.whitelist</code>.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>column.blacklist</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><em>empty string</em></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>An optional comma-separated list of regular expressions that match the fully-qualified names of columns that should be excluded from change event message values. Fully-qualified names for columns are of the form <em>schemaName</em>.<em>tableName</em>.<em>columnName</em>. Note that primary key columns are always included in the event&#8217;s key, also if blacklisted from the value.</p> </div></div></td> </tr> </tbody> </table> <div class="paragraph"> <p>The following <em>advanced</em> configuration properties have good defaults that will work in most situations and therefore rarely need to be specified in the connector&#8217;s configuration.</p> </div> <table class="tableblock frame-all grid-all spread table table-bordered table-striped"> <colgroup> <col style="width: 35%;"> <col style="width: 10%;"> <col style="width: 55%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Property</th> <th class="tableblock halign-left valign-top">Default</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tfoot> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>snapshot.delay.ms</code><br> 0.9.0 and later</p> </div></div></td> <td class="tableblock halign-left valign-top"><div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>An interval in milli-seconds that the connector should wait before taking a snapshot after starting up;<br> Can be used to avoid snapshot interruptions when starting multiple connectors in a cluster, which may cause re-balancing of connectors.</p> </div></div></td> </tr> </tfoot> <tbody> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>snapshot.mode</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><em>initial</em></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>A mode for taking an initial snapshot of the structure and optionally data of captured tables. Supported values are <em>initial</em> (will take a snapshot of structure and data of captured tables; useful if topics should be populated with a complete representation of the data from the captured tables) and <em>initial_schema_only</em> (will take a snapshot of the structure of captured tables only; useful if only changes happening from now onwards should be propagated to topics). Once the snapshot is complete, the connector will continue reading change events from the database&#8217;s redo logs.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>snapshot.locking.mode</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><em>none</em></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Controls how long the connector locks the monitored tables for snapshot execution. The default is <em>none</em> which means that the connector does not hold any locks for all monitored tables. Using a value of <em>exclusive</em> ensures that the connector holds the exclusive lock (and thus prevents any concurrent reads and updates) for all monitored tables. <em>snapshot</em> mode, in turn, runs the entire snapshot in snapshot transaction isolation level, thus neither table locks nor row-level locks are acquired. Concurrent DDL statements affecting captured tables must not be executed during initial load in snapshot mode to avoid potentially inconsistent schema metadata.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>poll.interval.ms</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>1000</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Positive integer value that specifies the number of milliseconds the connector should wait during each iteration for new change events to appear. Defaults to 1000 milliseconds, or 1 second.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>max.queue.size</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>8192</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Positive integer value that specifies the maximum size of the blocking queue into which change events read from the database log are placed before they are written to Kafka. This queue can provide backpressure to the binlog reader when, for example, writes to Kafka are slower or if Kafka is not available. Events that appear in the queue are not included in the offsets periodically recorded by this connector. Defaults to 8192, and should always be larger than the maximum batch size specified in the <code>max.batch.size</code> property.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>max.batch.size</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>2048</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Positive integer value that specifies the maximum size of each batch of events that should be processed during each iteration of this connector. Defaults to 2048.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>heartbeat.interval.ms</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>0</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Controls how frequently heartbeat messages are sent.<br> This property contains an interval in milli-seconds that defines how frequently the connector sends messages into a heartbeat topic. This can be used to monitor whether the connector is still receiving change events from the database. You also should leverage heartbeat messages in cases where only records in non-captured tables are changed for a longer period of time. In such situation the connector would proceed to read the log from the database but never emit any change messages into Kafka, which in turn means that no offset updates will be committed to Kafka. This may result in more change events to be re-sent after a connector restart. Set this parameter to <code>0</code> to not send heartbeat messages at all.<br> Disabled by default.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>heartbeat.topics.prefix</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p><code>__debezium-heartbeat</code></p> </div></div></td> <td class="tableblock halign-left valign-top"><div><div class="paragraph"> <p>Controls the naming of the topic to which heartbeat messages are sent.<br> The topic is named according to the pattern <code>&lt;heartbeat.topics.prefix&gt;.&lt;server.name&gt;</code>.</p> </div></div></td> </tr> </tbody> </table> <div class="paragraph"> <p>The connector also supports <em>pass-through</em> configuration properties that are used when creating the Kafka producer and consumer. Specifically, all connector configuration properties that begin with the <code>database.history.producer.</code> prefix are used (without the prefix) when creating the Kafka producer that writes to the database history, and all those that begin with the prefix <code>database.history.consumer.</code> are used (without the prefix) when creating the Kafka consumer that reads the database history upon connector startup.</p> </div> <div class="paragraph"> <p>For example, the following connector configuration properties can be used to <a href="http://kafka.apache.org/documentation.html#security_configclients">secure connections to the Kafka broker</a>:</p> </div> <div class="paragraph"> <p>In addition to the <em>pass-through</em> to the Kafka producer and consumer, the properties starting with <code>database.</code>, e.g. <code>database.applicationName=debezium</code> are passed to the JDBC URL.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code>database.history.producer.security.protocol=SSL&#x000A;database.history.producer.ssl.keystore.location=/var/private/ssl/kafka.server.keystore.jks&#x000A;database.history.producer.ssl.keystore.password=test1234&#x000A;database.history.producer.ssl.truststore.location=/var/private/ssl/kafka.server.truststore.jks&#x000A;database.history.producer.ssl.truststore.password=test1234&#x000A;database.history.producer.ssl.key.password=test1234&#x000A;database.history.consumer.security.protocol=SSL&#x000A;database.history.consumer.ssl.keystore.location=/var/private/ssl/kafka.server.keystore.jks&#x000A;database.history.consumer.ssl.keystore.password=test1234&#x000A;database.history.consumer.ssl.truststore.location=/var/private/ssl/kafka.server.truststore.jks&#x000A;database.history.consumer.ssl.truststore.password=test1234&#x000A;database.history.consumer.ssl.key.password=test1234</code></pre> </div> </div> <div class="paragraph"> <p>Be sure to consult the <a href="http://kafka.apache.org/documentation.html">Kafka documentation</a> for all of the configuration properties for Kafka producers and consumers. (The SQL Server connector does use the <a href="http://kafka.apache.org/documentation.html#newconsumerconfigs">new consumer</a>.)</p> </div> </div> </div> </div> </div> </div> </div> <footer class="container"> <div class="row"> <div class="col-md-5 col-md-offset-1"> <h4>Debezium</h4> <p> &#169; 2019 Debezium Community <br> <br> <i class="icon-fire"></i> Mixed with <a href="http://twitter.github.com/bootstrap">Bootstrap</a>, baked by <a href="http://awestruct.org">Awestruct</a>. <br> <i class="icon-flag"></i> Website and docs licensed under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>. <br> <i class="icon-flag-alt"></i> Code released under <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License, v2.0</a>. <br> <i class="icon-file-alt"></i> <a href="https://www.redhat.com/legal/legal_statement.html" title="Terms">Terms</a> | <a href="https://www.redhat.com/legal/privacy_statement.html" title="Privacy Policy">Privacy</a> </p> </div> <div class="col-md-3"> <h4>Documentation</h4> <ul class="list-unstyled"> <li> <a href="/docs/features/" title="Features">Features</a> </li> <li> <a href="/docs/install/" title="Install">Install</a> </li> <li> <a href="/docs/manage/" title="Manage">Manage</a> </li> <li> <a href="/docs/architecture/" title="Architecture">Architecture</a> </li> <li> <a href="/docs/faq/" title="FAQ">FAQ</a> </li> <li> <a href="/docs/contribute/" title="Contribute">Contribute</a> </li> </ul> </div> <div class="col-md-3"> <h4>Connect</h4> <ul class="list-unstyled"> <li> <a href="/blog" title="Blog">Blog</a> </li> <li> <a href="http://twitter.com/debezium" title="Twitter">Twitter</a> </li> <li> <a href="http://github.com/debezium" title="GitHub">GitHub</a> </li> <li> <a href="https://gitter.im/debezium/dev" title="Chat">Chat</a> </li> <li> <a href="https://groups.google.com/forum/#!forum/debezium" title="Google Groups">Google Groups</a> </li> <li> <a href="http://stackoverflow.com/questions/tagged/debezium" title="StackOverflow">StackOverflow</a> </li> </ul> </div> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="https://www.redhat.com/"><img src="https://static.jboss.org/theme/images/common/redhat_logo.png"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="https://static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script type='text/javascript' language='JavaScript' src='https://www.redhat.com/j/elqNow/elqCfg.js'></script> <script type='text/javascript' language='JavaScript' src='https://www.redhat.com/j/elqNow/elqImg.js'></script> <div id="oTags"> <script type="text/javascript" src="//www.redhat.com/j/s_code.js"></script> <script type="text/javascript"><!--
        var coreUrl = encodeURI(document.URL.split("?")[0]).replace(/-/g," ");
        var urlSplit = coreUrl.toLowerCase().split(/\//);
        var urlLast = urlSplit[urlSplit.length-1];
        var pageNameString = "";
        var siteName = "";
        var minorSectionIndex = 3
        if (urlLast == "") {
            urlSplit.splice(-1,1);
        }
        if (urlLast.search(/\./) >= 0) {
            if (urlLast == "index.html") {
                urlSplit.splice(-1,1);
            }
            else {
                urlSplit[urlSplit.length-1] = urlLast.split(".").splice(0,1);
            }
        }
        siteName = urlSplit[2].split(".")[1];
        s.prop14 = s.eVar27 = siteName || "";
        s.prop15 = s.eVar28 = urlSplit[minorSectionIndex] || "";
        s.prop16 = s.eVar29 = urlSplit[minorSectionIndex+1] || "";
        pageNameString = urlSplit.splice(3).join(" | ");
        s.pageName = "jboss | community | " + siteName + " | " + pageNameString;
        s.server = "jboss";
        s.channel = "jboss | community";
        s.prop4 = s.eVar23 = encodeURI(document.URL);
        s.prop21 = s.eVar18 = coreUrl;
        s.prop2 = s.eVar22 = "en";
        s.prop3 = s.eVar19 = "us";
        //--></script> <script type="text/javascript" src="//www.redhat.com/j/rh_omni_footer.js"></script> <script language="JavaScript" type="text/javascript"><!--
        if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
        //--></script> <noscript><a href="http://www.omniture.com" title="Web Analytics"><img src="https://smtrcs.redhat.com/b/ss/redhatcom,redhatglobal/1/H.25.4--NS/0?[AQB]&cdp=3&[AQE]" height="1" width="1" border="0" alt=""/></a></noscript> </div> <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
      </script> <script type="text/javascript">
      try {
      var pageTracker = _gat._getTracker("UA-10656779-1");
      pageTracker._trackPageview();
      } catch(err) {}</script> <script>
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
       
      ga('create', 'UA-76464546-1', 'auto');
      ga('send', 'pageview');
      ga('set', 'anonymizeIp', true);
      ga('require', 'linkid', 'linkid.js');
      
      </script> </div> </body> </html>