<!DOCTYPE html> <html lang="en"> <head> <title>Debezium Blog</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="" name="description"> <meta content="" name="author"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <!--[if lt IE 9]><script src="https://static.jboss.org/theme/js/libs/html5/pre3.6/html5.min.js"></script><![endif]--> <link href="https://static.jboss.org/example/images/favicon.ico" rel="shortcut icon"> <link href="https://static.jboss.org/example/images/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="https://static.jboss.org/example/images/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="https://static.jboss.org/example/images/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="https://static.jboss.org/example/images/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="/stylesheets/debezium.css" rel="stylesheet" type="text/css"> <style>
      @media (min-width: 980px) {
        .banner { background-image: url(https://static.jboss.org/example/images/debezium-banner-1180px.png); height: 110px;  }
      }
      @media (max-width: 979px) {
        .banner { background-image: url(https://static.jboss.org/example/images/debezium-logo.png); background-repeat:no-repeat; background-position: center bottom; height: 60px; }
      }
      @media (max-width: 650px) {
        .banner { width: 100%; margin: 0px auto; }
      }
      @media (max-width: 450px) {
        .banner { height: 90px; }
      }
    </style> <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css" rel="stylesheet"> <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script src="https://static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <style>
      /* adjusting the vertical spacing for when a stickynav is engaged */
      .breadcrumb-fixed > .active {
        color: #8c8f91;
      }
      .breadcrumb-fixed {
        margin: 70px 0 10px;
        padding: 8px 15px;
        margin-bottom: 20px;
        list-style: none;
        background-color: #f5f5f5;
        border-radius: 4px;
      }
      
      .breadcrumb-fixed > li {
        display: inline-block;
      }
    </style> </head> <body> <div id="rhbar"> <a class="jbdevlogo" href="https://www.jboss.org/projects/about"></a> <a class="rhlogo" href="https://www.redhat.com/"></a> </div> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div class="container" id="content"> <div class="navbar navbar-inverse navbar-fix"> <div class="container-fluid"> <div class="navbar-header"> <button class="navbar-toggle collapsed" data-target="#navbar-1" data-toggle="collapse"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> Debezium </a> </div> <div class="collapse navbar-collapse" id="navbar-1"> <ul class="nav navbar-nav pull-right"> <li class=""><a href="/docs/faq/">FAQ</a></li> <li class=""><a href="/docs/">DOCS</a></li> <li class=""><a href="/community/">COMMUNITY</a></li> <li class="active"><a href="/blog/">BLOG</a></li> </ul> </div> </div> </div> <div id="equalHeightsLayout"> <div class="row post-text-padding row-no-expand"> <div class="hidden-xs col-sm-3 no-right-padding" id="leftdocnav"> <div class="panel-docnav"> <div class="panel-heading"> <h3 class="panel-title"> Latest posts </h3> </div> <div class="panel-body"> <ul class="list-group"> <li class="list-group-item"> <a href="/blog/2019/08/20/debezium-0-10-0-beta4-released/" rel="tooltip" title="Click to go to post">Debezium 0.10.0.Beta4 Released</a> </li> <li class="list-group-item"> <a href="/blog/2019/07/25/debezium-0-10-0-beta3-released/" rel="tooltip" title="Click to go to post">Debezium 0.10.0.Beta3 Released</a> </li> <li class="list-group-item"> <a href="/blog/2019/07/15/streaming-cassandra-at-wepay-part-2/" rel="tooltip" title="Click to go to post">Streaming Cassandra at WePay - Part 2</a> </li> <li class="list-group-item"> <a href="/blog/2019/07/12/streaming-cassandra-at-wepay-part-1/" rel="tooltip" title="Click to go to post">Streaming Cassandra at WePay - Part 1</a> </li> <li class="list-group-item"> <a href="/blog/2019/07/08/tutorial-sentry-debezium-container-images/" rel="tooltip" title="Click to go to post">Tutorial for Adding Sentry into Debezium Container Images</a> </li> <li class="list-group-item"> <a href="/blog/2019/06/28/debezium-0-10-0-beta2-released/" rel="tooltip" title="Click to go to post">Debezium 0.10.0.Beta2 Released</a> </li> <li class="list-group-item"> <a href="/blog/2019/06/19/debezium-wears-fedora/" rel="tooltip" title="Click to go to post">Debezium Wears Fedora</a> </li> <li class="list-group-item"> <a href="/blog/2019/06/12/debezium-0-10-0-beta1-released/" rel="tooltip" title="Click to go to post">Debezium 0.10.0.Beta1 Released</a> </li> </ul> </div> </div> </div> <div class="col-xs-12 col-sm-9" id="maincol"> <div class="text-right"> <h3> Subscribe <a class="rss" href="/blog.atom"> <i class="icon-rss"></i> </a> </h3> </div> <hr> <div class="post"> <h1 class="title"> <a href="/blog/2019/08/20/debezium-0-10-0-beta4-released/">Debezium 0.10.0.Beta4 Released</a> </h1> <div class="byline"> <p> <em> August 20, 2019 by Gunnar Morling </em> <em> under&nbsp; </em> <a class="label label-info" href="/blog/tags/releases/">releases</a> <a class="label label-info" href="/blog/tags/mysql/">mysql</a> <a class="label label-info" href="/blog/tags/postgres/">postgres</a> <a class="label label-info" href="/blog/tags/mongodb/">mongodb</a> <a class="label label-info" href="/blog/tags/sqlserver/">sqlserver</a> <a class="label label-info" href="/blog/tags/oracle/">oracle</a> <a class="label label-info" href="/blog/tags/docker/">docker</a> </p> </div> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>The temperatures are slowly cooling off after the biggest summer heat, an the Debezium community is happy to announce the release of Debezium <strong>0.10.0.Beta4</strong>. In this release we&#8217;re happy to share some news we don&#8217;t get to share too often: with <a href="http://cassandra.apache.org/">Apache Cassandra</a>, another database gets added to the list of databases supported by Debezium!</p> </div> <div class="paragraph"> <p>In addition, we finished our efforts for rebasing the existing Postgres connector to Debezium framework structure established for the SQL Server and Oracle connectors. This means more shared coded between these connectors, and in turn reduced maintenance efforts for the development team going forward; but there&#8217;s one immediately tangible advantage for you coming with this, too: the Postgres connector now exposes the same metrics you already know from the other connectors.</p> </div> <div class="paragraph"> <p>Finally, the new release contains a range of bugfixes and other useful improvements. Let&#8217;s explore some details below.</p> </div> </div> </div> <div class="sect1"> <h2 id="incubating_cassandra_connector"><a class="anchor" href="#incubating_cassandra_connector"></a>Incubating Cassandra Connector</h2> <div class="sectionbody"> <div class="paragraph"> <p>If you have been following this blog lately, you&#8217;ll have read about the latest addition to the Debezium family in Joy Gao&#8217;s excellent posts about the new connector (<a href="/blog/2019/07/12/streaming-cassandra-at-wepay-part-1/">part 1</a>, <a href="/blog/2019/07/15/streaming-cassandra-at-wepay-part-2/">part 2</a>).</p> </div> <div class="paragraph"> <p>In case you haven&#8217;t read those yet, we&#8217;d highly recommend to do so in order to learn more about the challenges encountered when implementing a CDC connector for a distributed datastore such as Cassandra as well as the design decisions made in order to come up with a first "minimal viable product". Joy also did a <a href="https://www.infoq.com/presentations/wepay-database-streaming/">great talk at QCon</a> last year, which touches on the topic of CDC for Cassandra.</p> </div> <div class="paragraph"> <p>Having been originally developed internally at <a href="/blog/2017/02/22/Debezium-at-WePay/">long-term Debezium user</a> WePay, the <a href="https://wecode.wepay.com/">WePay team</a> decided to open-source their work, put it under the Debezium umbrella and continue to evolve it there. That&#8217;s really great news for the Debezium community! We couldn&#8217;t be happier about this contribution and look forward to evolving this new connector together in the open.</p> </div> <div class="paragraph"> <p>At this point the Cassandra connector is in "incubating" state, i.e. its design and implementation are still pretty much in flux, the event structure which it creates may change in future releases etc. Note that, unlike the other Debezium connectors, this one currently is not based on Kafka Connect. Instead, it is implemented as a standalone process running on Cassandra node(s) themselves. Refer to the blog posts linked above for the reasoning behind this design and possible future developments around this. Needless to say, any ideas and contributions in this area will be highly welcomed.</p> </div> <div class="paragraph"> <p>Together with the connector we&#8217;ve also provided an initial draft of the <a href="/docs/connectors/cassandra">connector documentation</a>; this is still work-in-progress and will be amended in the next few days.</p> </div> </div> </div> <div class="sect1"> <h2 id="further_new_features"><a class="anchor" href="#further_new_features"></a>Further New Features</h2> <div class="sectionbody"> <div class="paragraph"> <p>The Postgres connector supports the metrics known from SQL Server and Oracle now (<a href="https://issues.jboss.org/browse/DBZ-777">DBZ-777</a>). When using the SQL Server connector, it is now ensured that tables are snapshotted in a deterministic order, as defined by the given table whitelist configuration (<a href="https://issues.jboss.org/browse/DBZ-1254">DBZ-1254</a>).</p> </div> <div class="paragraph"> <p>There have also been two improvements to our SMTs (single message transformations):</p> </div> <div class="ulist"> <ul> <li> <p>The SMT for <a href="/docs/configuration/event-flattening/">new record state extraction</a> allows to add additional columns for propagating metadata fields from the <code>source</code> block (<a href="https://issues.jboss.org/browse/DBZ-1395">DBZ-1395</a>, e.g. useful to propagate the transaction into sink tables).</p> </li> <li> <p>The default structure produced by the <a href="/docs/configuration/outbox-event-router/">outbox routing SMT</a> has been further streamlined (<a href="https://issues.jboss.org/browse/DBZ-1385">DBZ-1385</a>); the message value will now only contain the contents of the configured outbox table payload column. In case you want to re-add the <code>eventType</code> value, you can configure it as an "additional field", which either goes into the message as a header (recommended) or into the message value, which as before will be a nested structure then.</p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="bugfixes_and_other_improvements"><a class="anchor" href="#bugfixes_and_other_improvements"></a>Bugfixes and Other Improvements</h2> <div class="sectionbody"> <div class="paragraph"> <p>Finally, here&#8217;s an overview of asorted bugfixes in the 0.10 Beta4 release:</p> </div> <div class="ulist"> <ul> <li> <p>The MySQL connector handles <code>GRANT DELETE ON &lt;table&gt;</code> statements correctly (<a href="https://issues.jboss.org/browse/DBZ-1411">DBZ-1411</a>)</p> </li> <li> <p>Superfluous tables scans are avoided when using the <code>initial_schema_only</code> snapshot strategy with SQL Server (<a href="https://issues.jboss.org/browse/DBZ-1417">DBZ-1417</a>)</p> </li> <li> <p>The superfluous creation of connections is avoided when obtaining the xmin position of Postgres (<a href="https://issues.jboss.org/browse/DBZ-1381">DBZ-1381</a>)</p> </li> <li> <p>The new record state extraction SMT handles heartbeat events correctly (<a href="https://issues.jboss.org/browse/DBZ-1430">DBZ-1430</a>)</p> </li> </ul> </div> <div class="paragraph"> <p>Please refer to the 0.10.0.Beta4 <a href="/docs/releases/#release-0-10-0-beta4">release notes</a> for the complete list of addressed issues and the upgrading procedure.</p> </div> <div class="paragraph"> <p>A big thank you goes out to all the contributors from the Debezium community who worked on this release: <a href="https://github.com/jgao54">Joy Gao</a>, <a href="https://github.com/renatomefi">Renato Mefi</a> and <a href="https://github.com/willome">Guillaume Rosauro</a>!</p> </div> </div> </div> <div class="sect1"> <h2 id="about_debezium"><a class="anchor" href="#about_debezium"></a>About Debezium</h2> <div class="sectionbody"> <div class="paragraph"> <p>Debezium is an open source distributed platform that turns your existing databases into event streams, so applications can see and respond almost instantly to each committed row-level change in the databases. Debezium is built on top of <a href="http://kafka.apache.org/">Kafka</a> and provides <a href="http://kafka.apache.org/documentation.html#connect">Kafka Connect</a> compatible connectors that monitor specific database management systems. Debezium records the history of data changes in Kafka logs, so your application can be stopped and restarted at any time and can easily consume all of the events it missed while it was not running, ensuring that all events are processed correctly and completely. Debezium is <a href="/license/">open source</a> under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License, Version 2.0</a>.</p> </div> </div> </div> <div class="sect1"> <h2 id="get_involved"><a class="anchor" href="#get_involved"></a>Get involved</h2> <div class="sectionbody"> <div class="paragraph"> <p>We hope you find Debezium interesting and useful, and want to give it a try. Follow us on Twitter <a href="https://twitter.com/debezium">@debezium</a>, <a href="https://gitter.im/debezium/user">chat with us on Gitter</a>, or join our <a href="https://groups.google.com/forum/#!forum/debezium">mailing list</a> to talk with the community. All of the code is open source <a href="https://github.com/debezium/">on GitHub</a>, so build the code locally and help us improve ours existing connectors and add even more connectors. If you find problems or have ideas how we can improve Debezium, please let us know or <a href="https://issues.jboss.org/projects/DBZ/issues/">log an issue</a>.</p> </div> </div> </div> </div> <hr> <div class="post"> <h1 class="title"> <a href="/blog/2019/07/25/debezium-0-10-0-beta3-released/">Debezium 0.10.0.Beta3 Released</a> </h1> <div class="byline"> <p> <em> July 25, 2019 by Jiri Pechanec </em> <em> under&nbsp; </em> <a class="label label-info" href="/blog/tags/releases/">releases</a> <a class="label label-info" href="/blog/tags/mysql/">mysql</a> <a class="label label-info" href="/blog/tags/postgres/">postgres</a> <a class="label label-info" href="/blog/tags/mongodb/">mongodb</a> <a class="label label-info" href="/blog/tags/sqlserver/">sqlserver</a> <a class="label label-info" href="/blog/tags/oracle/">oracle</a> <a class="label label-info" href="/blog/tags/docker/">docker</a> </p> </div> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>The summer is at its peak but Debezium community is not relenting in its effort so the Debezium <strong>0.10.0.Beta3</strong> is released.</p> </div> <div class="paragraph"> <p>This version not only continues in incremental improvements of Debezium but also brings new shiny features.</p> </div> <div class="paragraph"> <p>All of you who are using PostgreSQL 10 and higher as a service offered by different cloud providers definitely felt the complications when you needed to deploy logical decoding plugin necessary to enable streaming. This is no longer necessary. Debezium now supports (<a href="https://issues.jboss.org/browse/DBZ-766">DBZ-766</a>) <a href="https://www.postgresql.org/docs/10/protocol-logical-replication.html">pgoutput</a> replication protocol that is available out-of-the-box since PostgreSQL 10.</p> </div> <div class="paragraph"> <p>There is a set of further minor improvements. The tombstones for deletes are configurable for all connectors now (<a href="https://issues.jboss.org/browse/DBZ-1365">DBZ-1365</a>). Also tables without primary keys are now supported for all connectors (<a href="https://issues.jboss.org/browse/DBZ-916">DBZ-916</a>). This further reduces the gap between old and new connectors capabilities.</p> </div> <div class="paragraph"> <p>There are improvements for heartbeat system. Heartbeat messages now contain the timestamp (<a href="https://issues.jboss.org/browse/DBZ-1363">DBZ-1363</a>) of when they were created in their body. The new messages are properly skipped by the Outbox router (<a href="https://issues.jboss.org/browse/DBZ-1388">DBZ-1388</a>). MySQL connector additionally uses heartbeats for <code>BinlogReader</code> (<a href="https://issues.jboss.org/browse/DBZ-1338">DBZ-1338</a>). MongoDB connector now utilizes heartbeats too (<a href="https://issues.jboss.org/browse/DBZ-1198">DBZ-1198</a>).</p> </div> <div class="paragraph"> <p>As we now that metrics are very important for keeping Debezium happy in production we have extended the set of supported metrics. A new metric count of events in error (<a href="https://issues.jboss.org/browse/DBZ-1222">DBZ-1222</a>) is added so it is easy to monitor any non-standards in processing. Database history recovery can take a long time during startup so it is now possible to monitor the progress of it (<a href="https://issues.jboss.org/browse/DBZ-1356">DBZ-1356</a>).</p> </div> <div class="paragraph"> <p>The other changes include updating of Docker images to use Kafka 2.3.0 (<a href="https://issues.jboss.org/browse/DBZ-1358">DBZ-1358</a>). PostgreSQL supports lockless snapshotting (<a href="https://issues.jboss.org/browse/DBZ-1238">DBZ-1238</a>) and Outbox router now process delete messages (<a href="https://issues.jboss.org/browse/DBZ-1320">DBZ-1320</a>).</p> </div> <div class="paragraph"> <p>We continue with stabilization of the 0.10 release line, with lots of bug fixes to the different connectors.</p> </div> <div class="paragraph"> <p>Multiple defects in MySQL parser have been fixed (<a href="https://issues.jboss.org/browse/DBZ-1398">DBZ-1398</a>, (<a href="https://issues.jboss.org/browse/DBZ-1397">DBZ-1397</a>, <a href="https://issues.jboss.org/browse/DBZ-1376">DBZ-1376</a>) and <code>SAVEPOINT</code> statements are no longer recorded in database history (<a href="https://issues.jboss.org/browse/DBZ-794">DBZ-794</a>).</p> </div> <div class="paragraph"> <p>Under certain circumstances, it was possible that PostgreSQL connector lost the first event while switching to streaming from the snapshot (<a href="https://issues.jboss.org/browse/DBZ-1400">DBZ-1400</a>).</p> </div> <div class="paragraph"> <p>Please refer to the 0.10.0.Beta3 <a href="/docs/releases/#release-0-10-0-beta3">release notes</a> to learn more about all resolved issues and the upgrading procedure.</p> </div> <div class="paragraph"> <p>Many thanks to everybody from the Debezium community who contributed to this release: <a href="https://github.com/addisonj">Addison Higham</a>, <a href="https://github.com/BinLi1988">Bin Li</a>, <a href="https://github.com/brbrown25">Brandon Brown</a> and <a href="https://github.com/renatomefi">Renato Mefi</a>.</p> </div> </div> </div> <div class="sect1"> <h2 id="about_debezium"><a class="anchor" href="#about_debezium"></a>About Debezium</h2> <div class="sectionbody"> <div class="paragraph"> <p>Debezium is an open source distributed platform that turns your existing databases into event streams, so applications can see and respond almost instantly to each committed row-level change in the databases. Debezium is built on top of <a href="http://kafka.apache.org/">Kafka</a> and provides <a href="http://kafka.apache.org/documentation.html#connect">Kafka Connect</a> compatible connectors that monitor specific database management systems. Debezium records the history of data changes in Kafka logs, so your application can be stopped and restarted at any time and can easily consume all of the events it missed while it was not running, ensuring that all events are processed correctly and completely. Debezium is <a href="/license/">open source</a> under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License, Version 2.0</a>.</p> </div> </div> </div> <div class="sect1"> <h2 id="get_involved"><a class="anchor" href="#get_involved"></a>Get involved</h2> <div class="sectionbody"> <div class="paragraph"> <p>We hope you find Debezium interesting and useful, and want to give it a try. Follow us on Twitter <a href="https://twitter.com/debezium">@debezium</a>, <a href="https://gitter.im/debezium/user">chat with us on Gitter</a>, or join our <a href="https://groups.google.com/forum/#!forum/debezium">mailing list</a> to talk with the community. All of the code is open source <a href="https://github.com/debezium/">on GitHub</a>, so build the code locally and help us improve ours existing connectors and add even more connectors. If you find problems or have ideas how we can improve Debezium, please let us know or <a href="https://issues.jboss.org/projects/DBZ/issues/">log an issue</a>.</p> </div> </div> </div> </div> <hr> <div class="post"> <h1 class="title"> <a href="/blog/2019/07/08/tutorial-sentry-debezium-container-images/">Tutorial for Adding Sentry into Debezium Container Images</a> </h1> <div class="byline"> <p> <em> July 08, 2019 by Renato Mefi </em> <em> under&nbsp; </em> <a class="label label-info" href="/blog/tags/sentry/">sentry</a> <a class="label label-info" href="/blog/tags/docker/">docker</a> </p> </div> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Debezium has received a huge improvement to the structure of its container images <a href="/blog/2019/06/03/debezium-0-10-0-alpha2-released/">recently</a>, making it extremely simple to extend its behaviour.</p> </div> <div class="paragraph"> <p>This is a small tutorial showing how you can for instance add <a href="https://sentry.io/welcome/">Sentry</a>, "an open-source error tracking [software] that helps developers monitor and fix crashes in real time". Here we&#8217;ll use it to collect and report any exceptions from Kafka Connect and its connectors. Note that this is only applicable for Debezium 0.9+.</p> </div> <div class="paragraph"> <p>We need a few things to have Sentry working, and we&#8217;ll add all of them and later have a Dockerfile which gets it all glued correctly:</p> </div> <div class="ulist"> <ul> <li> <p>Configure Log4j</p> </li> <li> <p>SSL certificate for <a href="https://sentry.io">sentry.io</a>, since it&#8217;s not by default in the JVM trusted chain</p> </li> <li> <p>The <code>sentry</code> and <code>sentry-log4j</code> libraries</p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="log4j_configuration"><a class="anchor" href="#log4j_configuration"></a>Log4j Configuration</h2> <div class="sectionbody"> <div class="paragraph"> <p>Let&#8217;s create a file <em>config/log4j.properties</em> in our local project which is a copy of the one shipped with Debezium images and add Sentry to it. Note we added <code>Sentry</code> to <code>log4j.rootLogger</code> and created the section <code>log4j.appender.Sentry</code>, the rest remains as the original configuration:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight"><code class="language-config" data-lang="config">kafka.logs.dir=logs&#x000A;&#x000A;log4j.rootLogger=INFO, stdout, appender, Sentry&#x000A;&#x000A;# Disable excessive reflection warnings - KAFKA-5229&#x000A;log4j.logger.org.reflections=ERROR&#x000A;&#x000A;log4j.appender.stdout=org.apache.log4j.ConsoleAppender&#x000A;log4j.appender.stdout.threshold=INFO&#x000A;log4j.appender.stdout.layout=org.apache.log4j.PatternLayout&#x000A;log4j.appender.stdout.layout.ConversionPattern=%d{ISO8601} %-5p  %X{dbz.connectorType}|%X{dbz.connectorName}|%X{dbz.connectorContext}  %m   [%c]%n&#x000A;&#x000A;log4j.appender.appender=org.apache.log4j.DailyRollingFileAppender&#x000A;log4j.appender.appender.DatePattern='.'yyyy-MM-dd-HH&#x000A;log4j.appender.appender.File=${kafka.logs.dir}/connect-service.log&#x000A;log4j.appender.appender.layout=org.apache.log4j.PatternLayout&#x000A;log4j.appender.appender.layout.ConversionPattern=%d{ISO8601} %-5p  %X{dbz.connectorType}|%X{dbz.connectorName}|%X{dbz.connectorContext}  %m   [%c]%n&#x000A;&#x000A;log4j.appender.Sentry=io.sentry.log4j.SentryAppender&#x000A;log4j.appender.Sentry.threshold=WARN</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="sentry_io_ssl_certificate"><a class="anchor" href="#sentry_io_ssl_certificate"></a>Sentry.io SSL certificate</h2> <div class="sectionbody"> <div class="paragraph"> <p>Download the <em>getsentry.pem</em> file from <a href="https://docs.sentry.io/ssl/">sentry.io</a> and put it in your project&#8217;s directory under <em>ssl/</em>.</p> </div> </div> </div> <div class="sect1"> <h2 id="the_dockerfile"><a class="anchor" href="#the_dockerfile"></a>The Dockerfile</h2> <div class="sectionbody"> <div class="paragraph"> <p>Now we can glue everything together in our Debezium image:</p> </div> <div class="ulist"> <ul> <li> <p>Let&#8217;s first create a JKS file with our Sentry certificate; this uses a Docker multi-stage building process, where we are generating a <code>certificates.jks</code> which we&#8217;ll later copy into our Kafka Connect with Debezium stage</p> </li> <li> <p>Copy <code>log4j.properties</code> into <code>$KAFKA_HOME/config/log4j.properties</code></p> </li> <li> <p>Copy the JKS file from the multi-stage build</p> </li> <li> <p>Set ENV with the Sentry version and m5sums</p> </li> <li> <p>Download Sentry dependencies, the script you see called <code>docker-maven-download</code> is a helper which we ship by default in our images. In this case we&#8217;re using it to download a JAR file from Maven Central and put it in the Kafka libs directory. We do that by setting the ENV var <code>MAVEN_DEP_DESTINATION=$KAFKA_HOME/libs</code>:</p> </li> </ul> </div> <div class="listingblock"> <div class="content"> <pre class="highlight"><code class="language-dockerfile" data-lang="dockerfile">FROM fabric8/java-centos-openjdk8-jdk:1.6 as ssl-jks&#x000A;&#x000A;ARG JKS_STOREPASS="any random password, you can also set it outside via the arguments from docker build"&#x000A;&#x000A;USER root:root&#x000A;&#x000A;COPY /ssl /ssl&#x000A;&#x000A;RUN chown -R jboss:jboss /ssl&#x000A;&#x000A;USER jboss:jboss&#x000A;&#x000A;WORKDIR /ssl&#x000A;&#x000A;RUN keytool -import -noprompt -alias getsentry \&#x000A;    -storepass "${JKS_STOREPASS}" \&#x000A;    -keystore certificates.jks \&#x000A;    -trustcacerts -file "/ssl/getsentry.pem"&#x000A;&#x000A;FROM debezium/connect:0.10 AS kafka-connect&#x000A;&#x000A;EXPOSE 8083&#x000A;&#x000A;COPY config/log4j.properties "$KAFKA_HOME/config/log4j.properties"&#x000A;&#x000A;COPY --from=ssl-jks --chown=kafka:kafka /ssl/certificates.jks /ssl/&#x000A;&#x000A;ENV SENTRY_VERSION=1.7.23 \&#x000A;    MAVEN_DEP_DESTINATION=$KAFKA_HOME/libs&#x000A;&#x000A;RUN docker-maven-download \&#x000A;        central io/sentry sentry "$SENTRY_VERSION" 4bf1d6538c9c0ebc22526e2094b9bbde &amp;&amp; \&#x000A;    docker-maven-download \&#x000A;        central io/sentry sentry-log4j "$SENTRY_VERSION" 74af872827bd7e1470fd966449637a77</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="build_and_run"><a class="anchor" href="#build_and_run"></a>Build and Run</h2> <div class="sectionbody"> <div class="paragraph"> <p>Now we can simply build the image:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight"><code class="language-bash" data-lang="bash">$ docker build -t debezium/connect-sentry:1 --build-arg=JKS_STOREPASS="123456789" .</code></pre> </div> </div> <div class="paragraph"> <p>When running the image we have now to configure our Kafka Connect application to load the JKS file by setting <code>KAFKA_OPTS: -Djavax.net.ssl.trustStore=/ssl/certificates.jks -Djavax.net.ssl.trustStorePassword=&lt;YOUR TRUSTSTORE PASSWORD&gt;</code>.</p> </div> <div class="paragraph"> <p>Sentry can be <a href="https://docs.sentry.io/clients/java/config/#id2">configured in many ways</a>, I like to do it via environment variables, the minimum we can set is the Sentry DSN (which is necessary to point to your project) and the actual running environment name (i.e.: production, staging).</p> </div> <div class="paragraph"> <p>In this case we can configure the variables: <code>SENTRY_DSN=&lt;GET THE DNS IN SENTRY&#8217;S DASHBOARD&gt;</code>, <code>SENTRY_ENVIRONMENT=dev</code>.</p> </div> <div class="paragraph"> <p>In case you&#8217;d like to learn more about using the Debezium container images, please <a href="/docs/tutorial/#starting_docker">check our tutorial</a>.</p> </div> <div class="paragraph"> <p>And that&#8217;s it, a basic a recipe for extending our Docker setup using Sentry as an example; other modifications should also be as simple as this one. As an example how a <code>RecordTooLarge</code> exception from the Kafka producer would look like in this setup, see the picture below:</p> </div> <div class="imageblock centered-image"> <img src="/images/sentry/example-record-too-large-exception.png" style="max-width:100%; margin-bottom:20px; margin-top:20px;" class="responsive-image" alt="Sentry Exception example"> </div> </div> </div> <div class="sect1"> <h2 id="conclusion"><a class="anchor" href="#conclusion"></a>Conclusion</h2> <div class="sectionbody"> <div class="paragraph"> <p>Thanks to the recent refactor of the Debezium container images, it got very easy to amend them with your custom extensions. Downloading external dependencies and adding them to the images became a trivial task and we&#8217;d love to hear your feedback about it!</p> </div> <div class="paragraph"> <p>If you are curious about the refactoring itself, you can find the details in pull request <a href="https://github.com/debezium/docker-images/pull/131">debezium/docker-images#131</a>.</p> </div> </div> </div> <div class="sect1"> <h2 id="about_debezium"><a class="anchor" href="#about_debezium"></a>About Debezium</h2> <div class="sectionbody"> <div class="paragraph"> <p>Debezium is an open source distributed platform that turns your existing databases into event streams, so applications can see and respond almost instantly to each committed row-level change in the databases. Debezium is built on top of <a href="http://kafka.apache.org/">Kafka</a> and provides <a href="http://kafka.apache.org/documentation.html#connect">Kafka Connect</a> compatible connectors that monitor specific database management systems. Debezium records the history of data changes in Kafka logs, so your application can be stopped and restarted at any time and can easily consume all of the events it missed while it was not running, ensuring that all events are processed correctly and completely. Debezium is <a href="/license/">open source</a> under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License, Version 2.0</a>.</p> </div> </div> </div> <div class="sect1"> <h2 id="get_involved"><a class="anchor" href="#get_involved"></a>Get involved</h2> <div class="sectionbody"> <div class="paragraph"> <p>We hope you find Debezium interesting and useful, and want to give it a try. Follow us on Twitter <a href="https://twitter.com/debezium">@debezium</a>, <a href="https://gitter.im/debezium/user">chat with us on Gitter</a>, or join our <a href="https://groups.google.com/forum/#!forum/debezium">mailing list</a> to talk with the community. All of the code is open source <a href="https://github.com/debezium/">on GitHub</a>, so build the code locally and help us improve ours existing connectors and add even more connectors. If you find problems or have ideas how we can improve Debezium, please let us know or <a href="https://issues.jboss.org/projects/DBZ/issues/">log an issue</a>.</p> </div> </div> </div> </div> <hr> <div class="post"> <h1 class="title"> <a href="/blog/2019/06/28/debezium-0-10-0-beta2-released/">Debezium 0.10.0.Beta2 Released</a> </h1> <div class="byline"> <p> <em> June 28, 2019 by Gunnar Morling </em> <em> under&nbsp; </em> <a class="label label-info" href="/blog/tags/releases/">releases</a> <a class="label label-info" href="/blog/tags/mysql/">mysql</a> <a class="label label-info" href="/blog/tags/postgres/">postgres</a> <a class="label label-info" href="/blog/tags/mongodb/">mongodb</a> <a class="label label-info" href="/blog/tags/sqlserver/">sqlserver</a> <a class="label label-info" href="/blog/tags/oracle/">oracle</a> <a class="label label-info" href="/blog/tags/docker/">docker</a> </p> </div> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>It&#8217;s my pleasure to announce the release of Debezium <strong>0.10.0.Beta2</strong>!</p> </div> <div class="paragraph"> <p>This further stabilizes the 0.10 release line, with lots of bug fixes to the different connectors. <a href="https://issues.jboss.org/issues/?jql=project%20%3D%20DBZ%20AND%20fixVersion%20%3D%200.10.0.Beta2">23 issues</a> were fixed for this release; a couple of those relate to the DDL parser of the MySQL connector, e.g. around <code>RENAME INDEX</code> (<a href="https://issues.jboss.org/browse/DBZ-1329">DBZ-1329</a>), <code>SET NEW</code> in triggers (<a href="https://issues.jboss.org/browse/DBZ-1331">DBZ-1331</a>) and function definitions with the <code>COLLATE</code> keyword (<a href="https://issues.jboss.org/browse/DBZ-1332">DBZ-1332</a>).</p> </div> <div class="paragraph"> <p>For the Postgres connector we fixed a potential inconsistency when flushing processed LSNs to the database (<a href="https://issues.jboss.org/browse/DBZ-1347">DBZ-1347</a>). Also the "include.unknown.datatypes" option works as expected now during snapshotting (<a href="https://issues.jboss.org/browse/DBZ-1335">DBZ-1335</a>) and the connector won&#8217;t stumple upon materialized views during snapshotting any longer (<a href="https://issues.jboss.org/browse/DBZ-1345">DBZ-1345</a>).</p> </div> <div class="paragraph"> <p>The SQL Server connector will use much less memory in many situations (<a href="https://issues.jboss.org/browse/DBZ-1065">DBZ-1065</a>) and it&#8217;s configurable now whether it should emit tombstone events for deletions or not (<a href="https://issues.jboss.org/browse/DBZ-835">DBZ-835</a>). This also was added for the Oracle connector, bringing consistency for this option across all the connectors.</p> </div> <div class="paragraph"> <p>Note that this release can be used with Apache Kafka 2.x, but not with 1.x. This was an unintentional change and compatibility with 1.x will be restored for the Beta3 release (the issue to track is <a href="https://issues.jboss.org/browse/DBZ-1361">DBZ-1361</a>).</p> </div> <div class="paragraph"> <p>Please refer to the 0.10.0.Beta2 <a href="/docs/releases/#release-0-10-0-beta2">release notes</a> to learn more about all resolved issues and the upgrading procedure.</p> </div> <div class="paragraph"> <p>Many thanks to everybody from the Debezium community who contributed to this release: <a href="https://github.com/pan3793">Cheng Pan</a>, <a href="https://github.com/willome">Guillaume Rosauro</a>, <a href="https://github.com/szczeles">Mariusz Strzelecki</a> and <a href="https://github.com/ssouris">Stathis Souris</a>.</p> </div> </div> </div> <div class="sect1"> <h2 id="about_debezium"><a class="anchor" href="#about_debezium"></a>About Debezium</h2> <div class="sectionbody"> <div class="paragraph"> <p>Debezium is an open source distributed platform that turns your existing databases into event streams, so applications can see and respond almost instantly to each committed row-level change in the databases. Debezium is built on top of <a href="http://kafka.apache.org/">Kafka</a> and provides <a href="http://kafka.apache.org/documentation.html#connect">Kafka Connect</a> compatible connectors that monitor specific database management systems. Debezium records the history of data changes in Kafka logs, so your application can be stopped and restarted at any time and can easily consume all of the events it missed while it was not running, ensuring that all events are processed correctly and completely. Debezium is <a href="/license/">open source</a> under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License, Version 2.0</a>.</p> </div> </div> </div> <div class="sect1"> <h2 id="get_involved"><a class="anchor" href="#get_involved"></a>Get involved</h2> <div class="sectionbody"> <div class="paragraph"> <p>We hope you find Debezium interesting and useful, and want to give it a try. Follow us on Twitter <a href="https://twitter.com/debezium">@debezium</a>, <a href="https://gitter.im/debezium/user">chat with us on Gitter</a>, or join our <a href="https://groups.google.com/forum/#!forum/debezium">mailing list</a> to talk with the community. All of the code is open source <a href="https://github.com/debezium/">on GitHub</a>, so build the code locally and help us improve ours existing connectors and add even more connectors. If you find problems or have ideas how we can improve Debezium, please let us know or <a href="https://issues.jboss.org/projects/DBZ/issues/">log an issue</a>.</p> </div> </div> </div> </div> <hr> <div class="post"> <h1 class="title"> <a href="/blog/2019/06/12/debezium-0-10-0-beta1-released/">Debezium 0.10.0.Beta1 Released</a> </h1> <div class="byline"> <p> <em> June 12, 2019 by Gunnar Morling </em> <em> under&nbsp; </em> <a class="label label-info" href="/blog/tags/releases/">releases</a> <a class="label label-info" href="/blog/tags/mysql/">mysql</a> <a class="label label-info" href="/blog/tags/postgres/">postgres</a> <a class="label label-info" href="/blog/tags/mongodb/">mongodb</a> <a class="label label-info" href="/blog/tags/sqlserver/">sqlserver</a> <a class="label label-info" href="/blog/tags/oracle/">oracle</a> <a class="label label-info" href="/blog/tags/docker/">docker</a> </p> </div> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Another week, another Debezium release&#8201;&#8212;&#8201;I&#8217;m happy to announce the release of Debezium <strong>0.10.0.Beta1</strong>!</p> </div> <div class="paragraph"> <p>Besides the upgrade to Apache Kafka 2.2.1 (<a href="https://issues.jboss.org/browse/DBZ-1316">DBZ-1316</a>), this mostly fixes some bugs, including a regression to the MongoDB connector introduced in the Alpha2 release (<a href="https://issues.jboss.org/browse/DBZ-1317">DBZ-1317</a>).</p> </div> <div class="paragraph"> <p>A very welcomed usability improvement is that the connectors will log a warning now if not at least one table is actually captured as per the whitelist/blacklist configuration (<a href="https://issues.jboss.org/browse/DBZ-1242">DBZ-1242</a>). This helps to prevent the accidental exclusion all tables by means of an incorrect filter expression, in which case the connectors "work as intended", but no events are propagated to the message broker.</p> </div> <div class="paragraph"> <p>Please see the <a href="/docs/releases/#release-0-10-0-beta1">release notes</a> for the complete list of issues fixed in this release. Also make sure to examine the upgrade guidelines for 0.10.0.Alpha1 and Alpha2 when upgrading from earlier versions.</p> </div> <div class="paragraph"> <p>Many thanks to community members <a href="https://github.com/pan3793">Cheng Pan</a> and <a href="https://github.com/ChingTsai">Ching Tsai</a> for their contributions to this release!</p> </div> </div> </div> <div class="sect1"> <h2 id="about_debezium"><a class="anchor" href="#about_debezium"></a>About Debezium</h2> <div class="sectionbody"> <div class="paragraph"> <p>Debezium is an open source distributed platform that turns your existing databases into event streams, so applications can see and respond almost instantly to each committed row-level change in the databases. Debezium is built on top of <a href="http://kafka.apache.org/">Kafka</a> and provides <a href="http://kafka.apache.org/documentation.html#connect">Kafka Connect</a> compatible connectors that monitor specific database management systems. Debezium records the history of data changes in Kafka logs, so your application can be stopped and restarted at any time and can easily consume all of the events it missed while it was not running, ensuring that all events are processed correctly and completely. Debezium is <a href="/license/">open source</a> under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License, Version 2.0</a>.</p> </div> </div> </div> <div class="sect1"> <h2 id="get_involved"><a class="anchor" href="#get_involved"></a>Get involved</h2> <div class="sectionbody"> <div class="paragraph"> <p>We hope you find Debezium interesting and useful, and want to give it a try. Follow us on Twitter <a href="https://twitter.com/debezium">@debezium</a>, <a href="https://gitter.im/debezium/user">chat with us on Gitter</a>, or join our <a href="https://groups.google.com/forum/#!forum/debezium">mailing list</a> to talk with the community. All of the code is open source <a href="https://github.com/debezium/">on GitHub</a>, so build the code locally and help us improve ours existing connectors and add even more connectors. If you find problems or have ideas how we can improve Debezium, please let us know or <a href="https://issues.jboss.org/projects/DBZ/issues/">log an issue</a>.</p> </div> </div> </div> </div> <hr> <ul class="pager"> <li class="previous"> <a href="/blog/tags/docker/page/2/">&laquo; Older</a> </li> <li class="pages">Page 1 of 11</li> <li class="disabled next"> <a href="#">Newer &raquo;</a> </li> </ul> </div> </div> </div> </div> <footer class="container"> <div class="row"> <div class="col-md-5 col-md-offset-1"> <h4>Debezium</h4> <p> &#169; 2019 Debezium Community <br> <br> <i class="icon-fire"></i> Mixed with <a href="http://twitter.github.com/bootstrap">Bootstrap</a>, baked by <a href="http://awestruct.org">Awestruct</a>. <br> <i class="icon-flag"></i> Website and docs licensed under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>. <br> <i class="icon-flag-alt"></i> Code released under <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License, v2.0</a>. <br> <i class="icon-file-alt"></i> <a href="https://www.redhat.com/legal/legal_statement.html" title="Terms">Terms</a> | <a href="https://www.redhat.com/legal/privacy_statement.html" title="Privacy Policy">Privacy</a> </p> </div> <div class="col-md-3"> <h4>Documentation</h4> <ul class="list-unstyled"> <li> <a href="/docs/features/" title="Features">Features</a> </li> <li> <a href="/docs/install/" title="Install">Install</a> </li> <li> <a href="/docs/manage/" title="Manage">Manage</a> </li> <li> <a href="/docs/architecture/" title="Architecture">Architecture</a> </li> <li> <a href="/docs/faq/" title="FAQ">FAQ</a> </li> <li> <a href="/docs/contribute/" title="Contribute">Contribute</a> </li> </ul> </div> <div class="col-md-3"> <h4>Connect</h4> <ul class="list-unstyled"> <li> <a href="/blog" title="Blog">Blog</a> </li> <li> <a href="http://twitter.com/debezium" title="Twitter">Twitter</a> </li> <li> <a href="http://github.com/debezium" title="GitHub">GitHub</a> </li> <li> <a href="https://gitter.im/debezium/dev" title="Chat">Chat</a> </li> <li> <a href="https://groups.google.com/forum/#!forum/debezium" title="Google Groups">Google Groups</a> </li> <li> <a href="http://stackoverflow.com/questions/tagged/debezium" title="StackOverflow">StackOverflow</a> </li> </ul> </div> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="https://www.redhat.com/"><img src="/images/Logo-Red_Hat-Sponsored_By-B-Standard-RGB.svg"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="https://static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script type='text/javascript' language='JavaScript' src='https://www.redhat.com/j/elqNow/elqCfg.js'></script> <script type='text/javascript' language='JavaScript' src='https://www.redhat.com/j/elqNow/elqImg.js'></script> <div id="oTags"> <script type="text/javascript" src="//www.redhat.com/j/s_code.js"></script> <script type="text/javascript"><!--
        var coreUrl = encodeURI(document.URL.split("?")[0]).replace(/-/g," ");
        var urlSplit = coreUrl.toLowerCase().split(/\//);
        var urlLast = urlSplit[urlSplit.length-1];
        var pageNameString = "";
        var siteName = "";
        var minorSectionIndex = 3
        if (urlLast == "") {
            urlSplit.splice(-1,1);
        }
        if (urlLast.search(/\./) >= 0) {
            if (urlLast == "index.html") {
                urlSplit.splice(-1,1);
            }
            else {
                urlSplit[urlSplit.length-1] = urlLast.split(".").splice(0,1);
            }
        }
        siteName = urlSplit[2].split(".")[1];
        s.prop14 = s.eVar27 = siteName || "";
        s.prop15 = s.eVar28 = urlSplit[minorSectionIndex] || "";
        s.prop16 = s.eVar29 = urlSplit[minorSectionIndex+1] || "";
        pageNameString = urlSplit.splice(3).join(" | ");
        s.pageName = "jboss | community | " + siteName + " | " + pageNameString;
        s.server = "jboss";
        s.channel = "jboss | community";
        s.prop4 = s.eVar23 = encodeURI(document.URL);
        s.prop21 = s.eVar18 = coreUrl;
        s.prop2 = s.eVar22 = "en";
        s.prop3 = s.eVar19 = "us";
        //--></script> <script type="text/javascript" src="//www.redhat.com/j/rh_omni_footer.js"></script> <script language="JavaScript" type="text/javascript"><!--
        if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
        //--></script> <noscript><a href="http://www.omniture.com" title="Web Analytics"><img src="https://smtrcs.redhat.com/b/ss/redhatcom,redhatglobal/1/H.25.4--NS/0?[AQB]&cdp=3&[AQE]" height="1" width="1" border="0" alt=""/></a></noscript> </div> <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
      </script> <script type="text/javascript">
      try {
      var pageTracker = _gat._getTracker("UA-10656779-1");
      pageTracker._trackPageview();
      } catch(err) {}</script> <script>
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
       
      ga('create', 'UA-76464546-1', 'auto');
      ga('send', 'pageview');
      ga('set', 'anonymizeIp', true);
      ga('require', 'linkid', 'linkid.js');
      
      </script> </div> </body> </html>